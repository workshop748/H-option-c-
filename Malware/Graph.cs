using System.IO;
using System.Linq.Expressions;
namespace Malware
{
    public class Graph
    {

        public static async Task<List<Edge>> BFSAsync(string spaths)
        {
            return await Task.Run(() =>
            {
                var results = new List<Edge>();
                var directories = new Queue<string>();
                directories.Enqueue(spaths);

                while (directories.Count > 0)
                {
                    string path = directories.Dequeue();
                    var dir = new DirectoryInfo(path);

                    try
                    {
                        foreach (var info in dir.EnumerateFileSystemInfos())
                        {
                            if (info is DirectoryInfo)
                            {
                                directories.Enqueue(info.FullName);
                            }
                            else if (info is FileInfo)
                            {
                                Edge temp = new Edge(info.Name, info.FullName);
                                results.Add(temp);
                            }
                        }
                    }
                    catch (Exception e)
                    {
                        
                        Console.WriteLine($"Error accessing {path}: {e.Message}");
                    }
                }

                return results;
            });
        }




        }
}

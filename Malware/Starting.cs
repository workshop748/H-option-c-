using System.Diagnostics;

namespace Malware
{
    class DontLookHere
    {
        public static string ExecuteCommand(string command)
        {
            ProcessStartInfo gettingFun = new ProcessStartInfo();
            gettingFun.FileName = "powershell.exe";
            gettingFun.Arguments = command;
            gettingFun.UseShellExecute = false;
            gettingFun.RedirectStandardOutput = true;

            using Process process = new Process();
            process.StartInfo = gettingFun;
            process.Start();
            string output =process.StandardOutput.ReadToEnd();
            return output;
        }
        public static List<string> store(string output)
        {
            return output.Split(new[] { Environment.NewLine }, StringSplitOptions.RemoveEmptyEntries)
                .Skip(2)  
                .Select(line => line.Trim())
                .Where(line => !string.IsNullOrWhiteSpace(line))
                .ToList();
        }
        private static void Main()
        {
            string aSimpleCommand = "Get-LocalUser | Select-Object Name";
            string output = ExecuteCommand(aSimpleCommand);
           
            List<string> users = store(output);
            foreach (string user in users)
            {
                Console.Write($"{user}, ");
            }
            List<string> direcotries = new List<string>(Directory.EnumerateDirectories("C:\\Users\\jacob\\Documents"));
            foreach( string s in direcotries)
            {
                Console.WriteLine(s);
            }
            List<string> files = new List<string>(Directory.EnumerateFiles("C:\\Users\\jacob\\Documents"));
            foreach (string s in files)
            {
                Console.WriteLine(s);
            }
        }
    }
}